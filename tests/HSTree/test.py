import os
from py2neo import Node, Relationship, Graph, NodeMatcher, RelationshipMatcher, Subgraph
import time
import re
import pandas as pd
from io import StringIO
# graph = Graph('http://10.218.105.183:7474/', username='neo4j', password='2w2w2w2w')
graph = Graph('http://127.0.0.1:7474/', username='neo4j', password='2w2w2w2w')
node_matcher = NodeMatcher(graph)
relation_matcher = RelationshipMatcher(graph)
if __name__ == '__main__':
    data = """
389, 740, 67347190, 0.16950702667236328
2792, 4269, 980549653, 0.370697021484375
5834, 9476, 1528522246, 0.3851945400238037
7821, 12375, 726206911, 0.23854613304138184
8720, 14948, 692091824, 0.12731170654296875
12344, 20420, 1465652427, 0.5116221904754639
15481, 27695, 1503663932, 0.5109832286834717
3286, 4487, 2495758241, 0.42147374153137207
5263, 8068, 2448365927, 0.27007126808166504
12728, 20441, 3438703186, 1.0274791717529297
18517, 32080, 2961383460, 0.6726775169372559
24245, 44006, 3086777768, 0.6146667003631592
29372, 54202, 2571499583, 0.601841926574707
37083, 65436, 3443748506, 1.12552809715271
44495, 79122, 3568581861, 1.1070988178253174
49892, 86439, 2495999249, 0.8793776035308838
54790, 92545, 2136096664, 0.8295061588287354
58591, 99992, 1912791433, 0.45009303092956543
64831, 111804, 3100195600, 0.7552497386932373
69508, 120675, 2148636109, 0.5159969329833984
71914, 125300, 1035255563, 0.3002042770385742
72796, 126704, 286473281, 0.13752126693725586
74547, 129520, 617206918, 0.18081307411193848
75804, 131289, 407427496, 0.13355493545532227
76950, 132958, 344654893, 0.11837625503540039
78386, 134923, 1107870666, 0.15724778175354004
79831, 137522, 588006314, 0.21022677421569824
81032, 139263, 412586036, 0.1505436897277832
82160, 140916, 419045392, 0.12723588943481445
83093, 142382, 319946521, 0.1443653106689453
84074, 144179, 433511365, 0.1883103847503662
85108, 145744, 330847833, 0.14501428604125977
86106, 147273, 316971907, 0.1924116611480713
87482, 149178, 509853400, 0.15206027030944824
88670, 150880, 480803572, 0.13134050369262695
90107, 153227, 543706280, 0.15624666213989258
91847, 157897, 734476048, 0.22407269477844238
93294, 159873, 427407862, 0.13779854774475098
94677, 162279, 446720065, 0.16965150833129883
95644, 163765, 368202673, 0.19447803497314453
96922, 167380, 1130426146, 0.17430996894836426
98405, 169766, 584860067, 0.15189146995544434
99942, 171832, 476390302, 0.1592710018157959
101686, 174085, 572635705, 0.1617426872253418
102957, 175882, 407075087, 0.12723755836486816
104310, 178523, 543566613, 0.15845441818237305
106135, 182129, 746010441, 0.24761343002319336
107144, 184015, 329207842, 0.1578230857849121
108388, 185793, 355056950, 0.1358649730682373
109961, 189305, 529640621, 0.19198155403137207
111160, 191028, 461713292, 0.12368249893188477
112529, 192930, 391189760, 0.14393901824951172
113948, 194886, 397191445, 0.15372872352600098
115441, 198372, 613224956, 0.16148757934570312
116220, 199711, 317746418, 0.13070201873779297
117788, 202635, 1234921704, 0.2192075252532959
119102, 204470, 463447658, 0.13266921043395996
120601, 206498, 491822679, 0.15645241737365723
122303, 211044, 713968115, 0.21059250831604004
123540, 212804, 487018645, 0.13445281982421875
124763, 214545, 552388490, 0.13158607482910156
126256, 217213, 610909056, 0.16984915733337402
127612, 219800, 615452991, 0.1602799892425537
129096, 223365, 535358554, 0.24880290031433105
130366, 225892, 517084912, 0.16321682929992676
131224, 227268, 279289096, 0.12955570220947266
132778, 229353, 460371791, 0.1732938289642334
134145, 231663, 514579725, 0.1544489860534668
135560, 233612, 471126752, 0.15088629722595215
136958, 235939, 465013890, 0.15617823600769043
138687, 239393, 1302000402, 0.19513392448425293
140010, 241869, 483025732, 0.1643691062927246
141397, 245940, 560963977, 0.1814744472503662
142279, 247348, 371122936, 0.16796445846557617
143292, 248890, 369896615, 0.1449127197265625
145423, 251508, 671665374, 0.22098708152770996
146771, 253868, 467448745, 0.15499138832092285
147995, 255935, 459718002, 0.14514613151550293
149157, 257631, 341392495, 0.1983811855316162
150839, 259846, 473608000, 0.16242122650146484
152380, 262675, 545776288, 0.16263079643249512
153702, 264833, 470884855, 0.14803433418273926
155306, 267314, 548963394, 0.1583704948425293
156612, 269143, 381029792, 0.11924219131469727
158032, 271862, 502033706, 0.17073273658752441
159440, 273809, 1157582280, 0.14149045944213867
161009, 277368, 578100026, 0.21462726593017578
162587, 279476, 458038214, 0.15940475463867188
163918, 282159, 515349828, 0.15732288360595703
165586, 284339, 499057157, 0.15629267692565918
166849, 286461, 423920766, 0.11824178695678711
168075, 288638, 548395224, 0.13281464576721191
169120, 290710, 360229429, 0.1282656192779541
170707, 293250, 549651947, 0.16530656814575195
172099, 295157, 403729642, 0.14154314994812012
173269, 296856, 331587638, 0.17656397819519043
174467, 298580, 404444665, 0.12972617149353027
176115, 301790, 639808916, 0.17981934547424316
177336, 304382, 561034873, 0.1577920913696289
178165, 305733, 334360853, 0.13608789443969727
179202, 307637, 1209355648, 0.2586350440979004
180494, 309911, 482386179, 0.14761781692504883
181760, 312353, 515804390, 0.1612398624420166
183135, 314260, 460613327, 0.14763426780700684
184619, 316252, 513928744, 0.20743918418884277
186121, 318275, 573584204, 0.1510145664215088
187540, 320641, 519502421, 0.15717649459838867
188249, 322313, 253462280, 0.0972909927368164
189705, 324775, 452024437, 0.15796971321105957
190881, 326469, 378723839, 0.13680052757263184
192367, 328855, 531933074, 0.16934514045715332
193920, 331387, 488025812, 0.17680001258850098
194925, 332925, 305861349, 0.16029071807861328
196167, 334695, 424408264, 0.18866205215454102
197714, 336805, 505082364, 0.16916251182556152
199148, 339544, 1209030389, 0.17780375480651855
200909, 343018, 568930423, 0.210005521774292
202728, 345967, 666298558, 0.18820548057556152
204129, 347901, 414829082, 0.15935397148132324
205988, 351763, 640062901, 0.19194436073303223
207500, 354212, 540000624, 0.1661055088043213
208721, 356365, 471268915, 0.16026926040649414
209674, 357858, 325520399, 0.1512131690979004
210847, 359559, 398498632, 0.12244224548339844
212321, 361556, 451835681, 0.15477228164672852
213606, 363355, 413019121, 0.13347506523132324
215260, 365924, 583907068, 0.19218921661376953
216706, 367902, 485003581, 0.15003633499145508
218501, 371378, 621092107, 0.18212389945983887
220062, 373877, 520725786, 0.1546764373779297
221618, 375963, 1238770442, 0.1635279655456543
222951, 378173, 471092517, 0.23216533660888672
224394, 381753, 557212063, 0.16971731185913086
225741, 383623, 462845579, 0.12691020965576172
227260, 385666, 505539475, 0.14554071426391602
228644, 388212, 439949173, 0.1691591739654541
230031, 390566, 503572659, 0.15356063842773438
231064, 392523, 345546238, 0.15615558624267578
232746, 396462, 644443865, 0.18406224250793457
234125, 398370, 606836392, 0.14387798309326172
235507, 401136, 519294951, 0.18616151809692383
236761, 402907, 429043122, 0.12935733795166016
238411, 407563, 654275196, 0.21960926055908203
239848, 409528, 463948865, 0.1483747959136963
241298, 411764, 588719406, 0.15087676048278809
242384, 413382, 1115548630, 0.11407160758972168
243962, 415464, 422116125, 0.1535167694091797
245538, 419546, 583533413, 0.20801806449890137
246963, 421494, 423474983, 0.12191295623779297
248555, 423600, 566911202, 0.15639543533325195
249851, 425664, 468122616, 0.18395280838012695
250979, 427318, 380351295, 0.12798857688903809
252488, 430873, 606197023, 0.1780686378479004
253724, 433459, 417216944, 0.1546943187713623
254673, 434937, 286418328, 0.153578519821167
256163, 436955, 467970590, 0.15840649604797363
257816, 439105, 467722135, 0.14895844459533691
259386, 441213, 549780058, 0.14676976203918457
261062, 443419, 520845061, 0.1776752471923828
262545, 446130, 578133565, 0.15691351890563965
263475, 448007, 1206224550, 0.12129354476928711
265006, 450316, 579804538, 0.2623145580291748
266395, 452508, 513159040, 0.14676547050476074
267954, 456389, 598268129, 0.18146514892578125
269389, 458350, 483950622, 0.13651776313781738
270795, 461220, 577270138, 0.1854112148284912
271950, 462900, 362059296, 0.13263297080993652
273665, 468763, 715773076, 0.22854137420654297
274809, 470887, 428068663, 0.147735595703125
276125, 472732, 490519549, 0.16022729873657227
277430, 474551, 513500544, 0.15181541442871094
278945, 477768, 604028413, 0.23413705825805664
280328, 479683, 553376027, 0.14582300186157227
282128, 482407, 630285333, 0.1951766014099121
283732, 485570, 721711908, 0.18311333656311035
287241, 491515, 1358885253, 0.31983160972595215
288241, 493033, 326644923, 0.18243169784545898
289676, 495782, 490222225, 0.16187691688537598
291099, 498128, 502903404, 0.15909171104431152
292589, 500915, 462068832, 0.1821279525756836
294261, 504141, 594628950, 0.1744847297668457
295434, 505833, 337678749, 0.20708751678466797
297098, 509187, 641755975, 0.1918926239013672
298337, 510955, 423777966, 0.13923263549804688
299467, 512615, 413183581, 0.1236419677734375
300713, 514432, 484246578, 0.11711549758911133
301964, 516210, 449828223, 0.15188980102539062
303345, 518413, 481573935, 0.14606094360351562
304750, 520340, 429959585, 0.13300085067749023
306159, 522252, 445981377, 0.1375410556793213
307433, 524053, 1206642178, 0.15798664093017578
308426, 525569, 298240928, 0.15029048919677734
309338, 527018, 360045910, 0.14053845405578613
310965, 529580, 640182748, 0.25169897079467773
312472, 534355, 524225462, 0.20672297477722168
313693, 536105, 358293024, 0.1254584789276123
315083, 538016, 403986246, 0.13051533699035645
316801, 540261, 462252386, 0.1523723602294922
318691, 543624, 661305131, 0.19120383262634277
320249, 546485, 524289050, 0.16870784759521484
321540, 548699, 448125078, 0.15692973136901855
323333, 552091, 736249511, 0.17412137985229492
324715, 553996, 542756980, 0.13270235061645508
326634, 557571, 711310155, 0.18274474143981934
327688, 559152, 339035518, 0.14257001876831055
328733, 561206, 1230997480, 0.11913323402404785
329691, 562693, 386666226, 0.16128969192504883
330767, 564292, 388799696, 0.12178897857666016
332170, 566566, 542108282, 0.14677691459655762
333400, 568318, 455631766, 0.14182567596435547
336484, 574322, 580776934, 0.2701876163482666
337916, 576277, 417308665, 0.1373441219329834
339338, 578221, 391664846, 0.12904095649719238
340856, 580737, 498072606, 0.16556453704833984
342040, 582446, 360448187, 0.11977124214172363
343094, 584028, 429012403, 0.21741771697998047
344223, 585686, 396286551, 0.129835844039917
345658, 588099, 543097711, 0.1664278507232666
347408, 590357, 576501562, 0.13455629348754883
349110, 592942, 507735625, 0.1634840965270996
351408, 597252, 1709423029, 0.22008466720581055
352615, 598980, 444928167, 0.13495731353759766
353623, 600523, 313326117, 0.15193915367126465
355557, 604947, 707015082, 0.2575252056121826
356993, 607330, 533315522, 0.13560128211975098
358645, 610112, 541301354, 0.18201065063476562
360145, 612755, 551928670, 0.18700551986694336
361241, 614382, 385879172, 0.12500548362731934
362892, 616577, 531576548, 0.1503605842590332
364275, 618492, 465896594, 0.1307973861694336
365745, 620493, 428580339, 0.14020228385925293
367396, 623581, 574121765, 0.19732046127319336
368898, 626182, 530089150, 0.16371989250183105
369929, 628230, 354865996, 0.13608407974243164
370918, 629747, 317730768, 0.1691122055053711
372285, 632155, 1316414157, 0.16602349281311035
373597, 635764, 616701875, 0.17184734344482422
374508, 637215, 285963780, 0.13697409629821777
376576, 639819, 654817910, 0.20328330993652344
378581, 642448, 3771545583, 0.17624759674072266
380239, 644641, 615229395, 0.13846302032470703
381367, 646291, 331358414, 0.13465547561645508
382635, 648971, 1083371992, 0.21851229667663574
383570, 652077, 655501722, 0.15116405487060547
384508, 653569, 296048981, 0.14500188827514648
385394, 654980, 320630910, 0.1417679786682129
387106, 657219, 587038549, 0.15500402450561523
388393, 659046, 425839461, 0.1500413417816162
389806, 660986, 475866016, 0.15171098709106445
391462, 664266, 584800158, 0.18828415870666504
392661, 666374, 1284051652, 0.18923282623291016
393654, 668258, 356565662, 0.26848459243774414
394612, 670581, 375921219, 0.140455961227417
396328, 673089, 589364369, 0.14994502067565918
397915, 675249, 564306178, 0.13344216346740723
399179, 677036, 373863646, 0.1391735076904297
400332, 678711, 375829953, 0.13310837745666504
401711, 680625, 449151849, 0.17222833633422852
403284, 683022, 585053831, 0.1489262580871582
404785, 686409, 544904629, 0.1667797565460205
406088, 688243, 553810161, 0.1470661163330078
407879, 692721, 808630740, 0.20708942413330078
408901, 695107, 391382939, 0.13860559463500977
410064, 696799, 395473111, 0.12034392356872559
411854, 699406, 669336825, 0.18884825706481934
413301, 701402, 1378833323, 0.13306617736816406
414482, 703117, 364146737, 0.1172025203704834
416008, 705171, 500080921, 0.16701269149780273
417149, 706843, 301930902, 0.1328732967376709
418390, 708600, 362113881, 0.12519311904907227
419786, 710515, 417091553, 0.12420248985290527
421210, 712769, 469071680, 0.14992070198059082
422314, 714245, 421009429, 0.13683748245239258
423336, 715436, 404363198, 0.15243029594421387
424168, 716449, 273787929, 0.1124722957611084
425417, 718680, 546084243, 0.1374983787536621
426434, 720200, 472425363, 0.18642234802246094
427059, 721010, 307898954, 0.1182398796081543
428110, 722992, 517699040, 0.19984078407287598
    """
df = pd.read_csv(StringIO(data), header=None, names=['col1', 'col2', 'col3', 'col4'])
df.to_csv('perf_data.csv', index=False)
# Display the DataFrame
print(df)